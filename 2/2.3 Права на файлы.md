
[Лекция 2.3](https://www.youtube.com/watch?v=KrlYu1ToS-o&list=PLDyvV36pndZFHXjXuwA_NywNrVQO0aQqb&index=4)

# Права доступа в Linux (от себя)

<p align="justify"><font color="#2DC26B">Права в Linux</font> основаны на POSIX-системе и управляют тем, кто и что может делать с файлом или папкой. Они состоят из трёх частей: </p>

типов файлов, 
уровней доступа 
числового представления


Команда `ls -l` показывает права файлов и папок:

```bash
ls -l

# Вывод
-rwxr-xr-- 1 user group  1234 Feb 19 12:00 script.sh
```

![[Pasted image 20250219010711.png]]

---
## Типы файлов в Linux

Первая буква в выводе `ls -l` обозначает <font color="#2DC26B">тип объекта</font>:

- `-` → обычный файл (**файл**)
- `d` → директория (**папка**)
- `l` → символическая ссылка (**symlink**)
- `c` → символьное устройство (например, `/dev/tty`)
- `b` → блочное устройство (например, `/dev/sda`)

```bash
drwxr-xr-x  # Это папка
-rw-r--r--  # Это обычный файл
lrwxrwxrwx  # Это символическая ссылка
```

---
## Уровни доступа

После первой буквы идут **три группы прав**, каждая из которых состоит из **трёх символов**:

```bash
rwxr-xr--
```

- **Первые три (`rwx`)** → Права **владельца** файла.
- **Вторые три (`r-x`)** → Права **группы**, к которой относится файл.
- **Третьи три (`r--`)** → Права **остальных пользователей**.

<font color="#2DC26B">Каждый символ означает:</font>

- `r` (read) → **чтение** (можно просматривать содержимое)
- `w` (write) → **запись** (можно изменять содержимое)
- `x` (execute) → **исполнение** (можно запустить как программу)
- `-` → **нет разрешения**

```bash
-rwxr-xr--  → Владелец может читать, записывать и выполнять; группа может читать и выполнять; остальные могут только читать.
-rw-r--r--  → Владелец может читать и записывать; все остальные могут только читать.
-r-xr-xr-x  → Все могут читать и выполнять, но никто не может изменять.
```

Вместо `rwxr-xr--` можно записывать права **в числовом формате**, используя **восьмеричную систему**:

- `r = 4`
- `w = 2`
- `x = 1`
- `- = 0` (нет разрешения)

Складываем значения:

- `rwx` = `4+2+1` = **7**
- `r-x` = `4+0+1` = **5**
- `r--` = `4+0+0` = **4**

```bash
# Примеры:
- `777` → Полный доступ всем (`rwxrwxrwx`)
- `755` → Владелец может всё, остальные могут только читать и выполнять (`rwxr-xr-x`)
- `644` → Владелец может читать и записывать, остальные только читать (`rw-r--r--`)
```

Команда `chmod` меняет права файла:

```bash
chmod 755 script.sh
chmod 644 file.txt   # Владелец может читать и записывать, остальные только читать
chmod 700 private.sh # Только владелец может читать, записывать и выполнять
chmod 000 secret.txt # Никто не может ничего делать с файлом

=============================
Можно изменять права точечно:
=============================

chmod u+x script.sh  # Добавить владельцу право на выполнение (u = user)
chmod g-w file.txt   # Убрать право на запись у группы (g = group)
chmod o+r file.txt   # Разрешить остальным читать (o = others)
chmod a+x script.sh  # Разрешить всем выполнять (a = all)
```

---
В каждом файле есть **владелец** и **группа**:

```bash
-rw-r--r-- 1 user group 1234 Feb 19 12:00 file.txt

- `user` – владелец файла
- `group` – группа пользователей, которым разрешён доступ
```

Изменить
```bash
chown newuser file.txt # Изменить владельца

chown :newgroup file.txt # Группу

chown newuser:newgroup file.txt # Все сразу
```

Git **не сохраняет все права**, он учитывает только одно:

- Если файл **исполняемый**, то права `755`
- Если файл **не исполняемый**, то права `644`

---

![[Pasted image 20250219004420.png]]

<p align="justify">Обратите внимание на число 100644 в Git. Это значение представляет собой режим файла, который сохраняется в базе данных Git, и оно состоит из двух частей:</p>

100 – указывает, что объект является обычным файлом.

![[Pasted image 20250219004848.png]]

644 – обозначает права доступа к файлу.

Git не сохраняет всю совокупность прав доступа, а учитывает только один важный аспект – является ли файл исполнимым или нет.  
- Если файл **не исполнимый**, то права остаются **644**.  
- Если файл **исполнимый**, Git сохранит его с правами **755**.

---
<font color="#2DC26B">Исполняемый файл</font> — это файл, который можно запустить как программу без указания интерпретатора. Например:

- Обычный файл (`644`): можно открыть и прочитать, но не запустить.
- Исполняемый файл (`755`): можно запустить напрямую.

Для того чтобы сделать файл исполнимым, можно использовать команду:

```bash
chmod +x index.html
```

Для Git изменение прав на исполнение равносильно любым другим изменениям которые требуется коммитеть. 

---
# Как права работают в Windows и Unix?

- **В Unix-системах (Linux, macOS)**:
    
    - Права на выполнение (`x`) **отдельные** от прав на чтение (`r`).
    - Git **сохраняет информацию о правах выполнения**.

- **В Windows**:
    
    - Файловая система **не поддерживает отдельный флаг выполнения**.
    - Если файл доступен для чтения, значит, его можно запускать.
    - Git при инициализации репозитория **устанавливает специальную настройку**, отключающую отслеживание прав (`core.filemode=false`).

Чтобы проверить эту настройку, можно выполнить. Если она `false`, значит Git **не отслеживает** изменения прав.

```bash
git config --get core.filemode
```

Если мы работаем **в Windows**, но проект должен корректно работать в Unix, можно принудительно установить флаг выполнения **на уровне репозитория**:

```bash
git update-index --chmod=+x script.sh
git commit -m "Принудительно сделал script.sh исполняемым в Git"
```

Если файл ещё **не был добавлен в репозиторий**, аналогичный флаг можно указать при `git add`:

```bash
git add --chmod=+x script.sh
```

Это позволяет Git **запомнить исполняемый статус файла** даже в Windows, где этот флаг на файловой системе не отслеживается.



